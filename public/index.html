<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Earn Mini Bot</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="./assets/css/styles.css" rel="stylesheet" />
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script type="importmap">
    {
      "imports": {
        "firebase-app": "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js",
        "firebase-firestore": "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js",
        "firebase-auth": "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js"
      }
    }
  </script>
</head>

<body class="bg-light">
    <nav class="navbar bg-white border-bottom sticky-top px-3 py-2">
        <div class="d-flex align-items-center gap-2">
            <img src="./assets/img/logo.svg" alt="Logo" width="28" height="28" onerror="this.style.display='none'" />
            <span class="fw-bold">Earn Mini Bot</span>
        </div>
        <div id="userAvatar" class="avatar text-uppercase">U</div>
    </nav>

    <main class="container py-3 pb-5">
        <!-- Home -->
        <section id="page-home">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">Welcome</h5>
                    <p class="mb-2" id="welcomeName">Loading...</p>
                    <div class="d-flex gap-3">
                        <div class="stat">
                            <div class="stat-value" id="statPoints">0</div>
                            <div class="stat-label">Points</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="statTasks">0/15</div>
                            <div class="stat-label">Tasks Today</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="statRefs">0</div>
                            <div class="stat-label">Referrals</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-3">
                <div class="card">
                    <div class="card-body">
                        <h6 class="mb-2">Referral Link</h6>
                        <div class="input-group">
                            <input id="refLink" class="form-control" readonly value="Generating..." />
                            <button id="copyRef" class="btn btn-outline-secondary"><i
                                    class="bi bi-clipboard"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Earn -->
        <section id="page-earn" class="d-none">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">Earn Points</h5>
                    <p class="text-muted mb-2">Complete up to <span id="limitSpan">15</span> tasks per day. Each task =
                        <span id="pointsPerTaskSpan">1</span> point.</p>
                    <div class="progress mb-3" role="progressbar" aria-label="Tasks progress" aria-valuemin="0"
                        aria-valuemax="100">
                        <div id="taskProgress" class="progress-bar" style="width: 0%"></div>
                    </div>
                    <button id="startTask" class="btn btn-primary w-100">
                        <i class="bi bi-play-circle"></i> Start Task
                    </button>
                    <div id="adContainer" class="mt-3 d-none">
                        <div class="alert alert-info d-flex align-items-center gap-2">
                            <i class="bi bi-film"></i>
                            <div>
                                Watching ad... <span id="adCountdown">5</span>s
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Withdraw -->
        <section id="page-withdraw" class="d-none">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Withdraw</h5>
                    <form id="withdrawForm" class="row g-2">
                        <div class="col-12">
                            <label class="form-label">Method</label>
                            <select id="method" class="form-select" required></select>
                        </div>
                        <div class="col-12">
                            <label class="form-label">Account</label>
                            <input id="account" class="form-control" placeholder="017********" required />
                        </div>
                        <div class="col-12">
                            <label class="form-label">Amount (min 1000)</label>
                            <input id="amount" type="number" min="1000" step="1" class="form-control" required />
                        </div>
                        <div class="col-12 d-grid">
                            <button class="btn btn-success" type="submit"><i class="bi bi-cash-coin"></i> Request
                                Withdrawal</button>
                        </div>
                    </form>
                    <hr />
                    <h6>History</h6>
                    <div id="withdrawList" class="vstack gap-2"></div>
                </div>
            </div>
        </section>

        <!-- Profile -->
        <section id="page-profile" class="d-none">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex align-items-center gap-3">
                        <div id="profileAvatar" class="avatar avatar-lg text-uppercase">U</div>
                        <div>
                            <div class="fw-semibold" id="profileName">User</div>
                            <div class="text-muted" id="profileId">ID</div>
                        </div>
                    </div>
                    <hr />
                    <div class="row text-center">
                        <div class="col-4">
                            <div class="stat-value" id="pPoints">0</div>
                            <div class="stat-label">Points</div>
                        </div>
                        <div class="col-4">
                            <div class="stat-value" id="pTasks">0/15</div>
                            <div class="stat-label">Tasks</div>
                        </div>
                        <div class="col-4">
                            <div class="stat-value" id="pRefs">0</div>
                            <div class="stat-label">Referrals</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Floating Refer Button -->
    <button id="referBtn" class="btn btn-warning rounded-circle shadow refer-btn">
        <i class="bi bi-share-fill"></i>
    </button>

    <!-- Bottom Nav -->
    <nav class="navbar bg-white border-top fixed-bottom">
        <div class="container d-flex justify-content-around py-1">
            <button class="btn nav-btn active" data-target="home">
                <i class="bi bi-house"></i>
                <div class="small">Home</div>
            </button>
            <button class="btn nav-btn" data-target="earn">
                <i class="bi bi-lightning-charge"></i>
                <div class="small">Earn</div>
            </button>
            <button class="btn nav-btn" data-target="withdraw">
                <i class="bi bi-wallet2"></i>
                <div class="small">Withdraw</div>
            </button>
            <button class="btn nav-btn" data-target="profile">
                <i class="bi bi-person-circle"></i>
                <div class="small">Profile</div>
            </button>
        </div>
    </nav>

    <!-- Toasts -->
    <div class="toast-container position-fixed top-0 start-50 translate-middle-x p-3" id="toastContainer"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="./assets/js/app.js"></script>
</body>

</html>